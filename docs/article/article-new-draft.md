# Claude Codeで挑む広告管理システム開発 - 新卒エンジニアが学んだ効率的なAIペアプログラミング

## はじめに：散らばった広告管理を統合したい

現在弊社では、各メディアサイトではWordPressプラグインを使って記事に広告を埋め込んでいますが、以下の課題がありました：

- 広告コンテンツの管理が各サイトに分散
- 統一的な広告効果測定ができない
- WordPressの既存プログインは新しい広告の作成・配布が非効率

「これを統一的に管理できるシステムがあれば...」そんな思いから、新卒としてほぼ開発素人の状態から、Claude
Codeを活用してMVPを開発することに挑戦しました。

## Claude Codeとの出会い - なぜAIペアプロを選んだか

新卒で開発経験が浅い私にとって、以下の点でClaude Codeが最適でした：

1. **プロジェクト全体の文脈を理解**：ファイル構造やコードベース全体を把握
2. **ターミナルとの統合**：コマンド実行からデバッグまで一貫したサポート
3. **長時間の作業セッション**：会話の継続性が保たれる。会話の履歴が残る

GitHub Copilotと違い、**プロジェクト単位での深い理解**が可能な点が決め手でした。

## Claude Code実践編：効率化できた機能

### 1. カスタムコマンドで開発フローを自動化

`.claude/commands/`ディレクトリにカスタムコマンドを配置することで、頻繁に使う操作を自動化：

#### 実際に作成したカスタムコマンドの詳細

```text
1. /create-issue - GitHub issue作成とブランチ作成
会話コンテキストから要件を抽出し、適切なissueを生成
- issueテンプレート自動選択（bug.md / task.md）
- 既存ラベルから適切な選択
- ブランチ名の自動生成（feature/[issue番号]_[機能名]）

2. /create-pr - コミット分割とPR作成
変更内容を論理的な単位で分割してコミット
- README.md自動更新
- PRテンプレート適用
- 関連issue自動リンク

3. /update-pr - 既存PR内容更新
リモートの最新コミットを分析してPR説明を更新
- コミット内容の自動分析
- 影響範囲の特定

4. /read-issue - issue分析とソリューション提案
issue内容を分析し、実装難易度別の複数案を提示
- Bug/Task自動分類
- 関連コード特定
- MVP適合性評価

5. /tidy - コードベース整理
不要なコードや冗長な部分の自動検出と整理
```

### 2. プロジェクトメモリ（CLAUDE.md）の活用術

PR毎に`/init`を実行してプロジェクトメモリを更新する習慣が重要：

```text
# CLAUDE.mdに記載した内容の例

- プロジェクトの概要と目的
- APIエンドポイントの命名規則
- エラーハンドリングのパターン
- チーム固有のコーディング規約
- 頻出エラーと解決策
- 環境変数の説明
```

これにより、Claude Codeが常に最新のプロジェクト情報を把握できるようになりました。

### 3. @参照とbashコマンドの組み合わせ技

ファイル参照とコマンド実行を組み合わせることで、コンテキストを保ちながら作業：

```text
# 実際の使用例
@src/components/xxx.tsx のテストが失敗しています
エラーを解析して修正してください
```

### 4. プランモード（Shift+Tab 2回押し）での設計

複雑な機能実装前に、プランモードで全体設計を行うことで手戻りを削減
もしMaxプランを利用している場合、Opus Plan Mode（プランモードのみOpusを使う）に切り替えたら精度がかなり上がると同時にトークン節約できます。

```text
# プランモードの活用例
「xxx機能の全面リファクタリングを計画してください」
→ フェーズ分けされた詳細な実装計画を生成
```

## 苦労した点

### 1. 複数リポジトリ連携の課題

- **問題**：広告管理システム（Next.js）のAPI修正時、WordPress側のプラグインも修正が必要
    - 2つのClaude Codeセッション間でコピペが面倒
    - コンテキストとやり方のずれが生じる
    - API仕様の不整合が発生

- **解決**：`/add-dir`でWordPressリポジトリを同一セッションに統合

```text
# WordPressプラグインディレクトリを追加
/add-dir [second-repo-path]

# これにより実現できたこと：
- API設計の統一：両側のコードを同時修正
- データ形式の一致：JSONデータ構造を一貫管理
- デバッグの効率化：連携エラーを両方見ながら解決
```

### 2. issueの粒度問題

- **問題**：sub-issueの自動生成精度が低い
- **解決**：親issueのみClaude Codeに任せ、sub-issueは手動で分割

### 3. コンテキストの肥大化

長時間作業後、無関係な情報が混在

```text
# 解決策1：定期的なコンテキストクリア
/clear

# 解決策2：重要じゃない前提内容をcompact化
/compact

# 解決策3：Subagentの活用
/agents で専門タスクごとにエージェントを分離
```

## MCPサーバーSerenaによるトークン削減

### Serena導入のきっかけ

プロジェクト後半で直面した問題：

- 長時間作業によるコンテキスト肥大化
- 大規模ファイルの読み込みによるトークン消費
- 同じコードの繰り返し参照

これを解決するために**Serena MCPサーバー**を導入しました。

### Serena導入の体感効果

正直、具体的な数値測定はしていませんが、以下の点で明らかな改善を体感しました：

```markdown
## 体感した改善点

### トークン消費の削減

- ファイル全体を読む必要がなくなった
- 必要な関数だけピンポイントで取得できる
- 大規模ファイルでも気軽に調査できる

### 調査精度の向上

- indexによる高速検索で、見落としがなくなった
- memoriesで過去の調査結果を活用できる
- 影響範囲の把握が正確になった

### 作業効率の改善

- セッションを跨いでも文脈を維持できる
- 繰り返し同じ説明をする必要がない
```

## 今後試したい機能

### 1. git worktreeでの並列開発

```bash
# 機能Aと機能Bを並列で開発
git worktree add ../project-feature-a feature-a
git worktree add ../project-feature-b feature-b
```

### 3. 画像参照での実装

- デザインカンプを直接読み込んでUI実装
- スクショからのバグ修正

### 4. WebFetchツール

- 指定URLからのコンテンツ取得
- ドキュメント参照の自動化
- 外部API仕様の自動取得

### 5. Subagentでの並列処理

- 専門化されたエージェントによる効率化
- タスクごとのコンテキスト分離

## 成果と振り返り

### 開発効率

- 開発期間：2週間
- コード行数：約25,000行

### 新卒エンジニアとしての学び

1. **ベストプラクティスの習得**
    - Claude Codeが提案するコードから業界標準を学習
    - 適切なエラーハンドリングパターンの理解

2. **問題解決能力の向上**
    - エラーメッセージの読み方
    - デバッグの体系的アプローチ

3. **設計思考の獲得**
    - システム全体を俯瞰する視点
    - 将来の拡張性を考慮した実装

## チーム開発での活用法

### コードレビューの効率化

```text
# PR作成前のセルフレビュー
「このPRをレビューして改善点を指摘してください」
→ セキュリティ、パフォーマンス、可読性の観点から指摘
```

### ドキュメント自動生成

```text
# よく使うドキュメント生成
「プロジェクトの現状を反映したREADMEを作成」
「新メンバー向けの環境構築手順書を作成」
「APIの仕様書を生成」
```

## まとめ：Claude Codeは開発の相棒

開発素人だった私が、Claude Codeと共に本格的なシステムを構築できた理由：

1. **プロジェクト全体を理解**してくれる
    - ファイル構造、依存関係、ビジネスロジックまで把握
    - 継続的な会話で文脈を維持

2. **ベストプラクティスを提案**してくれる
    - 業界標準のコーディング規約
    - セキュリティやパフォーマンスの考慮

3. **エラーの原因を一緒に考えて**くれる
    - スタックトレースの解析
    - 段階的なデバッグアプローチ

特に新人エンジニアや、新技術に挑戦する方にとって、Claude Codeは強力な味方になるはずです。

### 最後に：Claude Codeを使い始める方へ

```text
# まずは基本コマンドを覚える
claude init  # プロジェクト設定
/help       # 使えるコマンドを確認
- @でファイル参照
- !bashでコマンド実行
- /initでメモリ更新
- ...

# 徐々に高度な機能へ
- カスタムコマンド作成
- Subagentの活用
- プランモードでの設計
- Hooksの活用

# そして最も重要なこと
「わからないことは素直に聞く」
→ Claude Codeは判断を押し付けず、一緒に考えてくれます
```

## 参考リンク

- [Claude Code公式ドキュメント](https://docs.anthropic.com/ja/docs/claude-code)
- [Claude Code Common Workflows](https://docs.anthropic.com/ja/docs/claude-code/common-workflows)
