# テンプレートシステム

> **関連資料**: [API仕様書](../api-reference.md) | [アーキテクチャ設計](../architecture.md)

## 広告テンプレートシステム

### 概要

HTMLベースの動的広告テンプレート作成・管理システム。`{{variableName}}` 形式のプレースホルダーを使用した柔軟な広告コンテンツ生成が可能です。

### 主要機能

- **HTMLエディター**: Monaco Editor による高機能コードエディター
- **プレースホルダーシステム**: `{{variableName}}` 形式の動的コンテンツ対応
- **バリデーション**: HTMLとプレースホルダーの整合性チェック
- **SEO対応**: 自動 `rel="nofollow"` 属性管理
- **CSV インポート/エクスポート**: テンプレートの一括管理機能
- **整合性監視**: テンプレート変更時の影響分析と既存コンテンツとの整合性チェック

### テンプレート作成フロー

1. **HTMLテンプレート設計**: Monaco Editorでの高機能編集
2. **プレースホルダー定義**: `{{title}}`、`{{image_url}}` 等の変数設定
3. **バリデーション実行**: HTMLとプレースホルダーの整合性確認
4. **SEO最適化**: 外部リンクの `rel="nofollow"` 自動適用

### 利用例

```html
<!-- 基本的な広告テンプレート例 -->
<div class="ad-banner">
  <h2>{{title}}</h2>
  <p>{{description}}</p>
  <img src="{{image_url}}" alt="{{alt_text}}">
  <a href="{{link_url}}" target="_blank">詳細を見る</a>
</div>
```

## URLテンプレートシステム

### 概要

UTMパラメータとカスタムパラメータを使用したトラッキングURL管理システム。キャンペーン別の効果測定とアナリティクス連携を実現します。

### 主要機能

- **UTMパラメータ管理**: 標準的なUTMトラッキング（source、medium、campaign、term、content）
- **カスタムパラメータ**: JSON形式での柔軟なパラメータ設定
- **URL生成**: ベースURLとパラメータの自動組み合わせ
- **テンプレート有効化**: 有効・無効の切り替え制御
- **CSV インポート/エクスポート**: URLテンプレートの一括管理

### URLテンプレート作成フロー

1. **ベースURL設定**: リンク先の基本URL入力
2. **UTMパラメータ設定**: キャンペーン識別用パラメータ設定
3. **カスタムパラメータ**: 独自の追跡パラメータ追加（JSON形式）
4. **プレビュー確認**: 生成される完全URLの確認

### 利用例

```json
{
  "name": "春季就活キャンペーン",
  "base_url": "https://example.com/register",
  "utm_source": "portcareer",
  "utm_medium": "banner",
  "utm_campaign": "2025_spring",
  "custom_params": {
    "user_type": "student",
    "grade": "senior"
  }
}
```

生成URL:
`https://example.com/register?utm_source=portcareer&utm_medium=banner&utm_campaign=2025_spring&user_type=student&grade=senior`

## テンプレート整合性システム

### 概要

テンプレート変更時の既存コンテンツへの影響を分析し、データ整合性を自動監視するシステムです。

### 主要機能

- **変更影響分析**: テンプレート変更前の影響予測
- **整合性チェック**: プレースホルダーの不整合検出
- **重要度分類**: critical、warning、infoレベルでの問題分類
- **自動警告**: ブレーキングチェンジの事前警告
- **データ同期**: テンプレート変更時の既存コンテンツ自動調整

### 監視項目

- **プレースホルダー不整合**: テンプレートとコンテンツ間の変数不一致
- **孤立したコンテンツ**: 削除されたテンプレートを参照するデータ
- **未使用プレースホルダー**: 定義されているが使用されない変数
- **パラメータマッピング競合**: 広告テンプレートとURLテンプレート間の競合

### 整合性レベル

| レベル          | 説明                | 対応        |
|--------------|-------------------|-----------|
| **Critical** | システム停止につながる重大な問題  | 即座の修正が必要  |
| **Warning**  | 機能に影響を与える可能性のある問題 | 計画的な修正を推奨 |
| **Info**     | 最適化の余地がある軽微な問題    | 改善検討事項    |

> **🔧 技術実装の詳細**: システムアーキテクチャと実装方法は [アーキテクチャ設計](../architecture.md) を参照  
> **📊 API仕様**: テンプレート操作のエンドポイントは [API仕様書](../api-reference.md) を参照
